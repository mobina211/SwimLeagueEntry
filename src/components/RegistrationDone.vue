<template>
  <div class="min-h-screen flex items-center justify-center p-4 md:p-6 overflow-hidden relative">
    <!-- Background celebration effect -->
    <div class="absolute inset-0 overflow-hidden bg-gradient-to-br from-emerald-900 via-green-900 to-cyan-900">
      <!-- Confetti animation -->
      <div v-for="i in 50" :key="'confetti-' + i" :class="`absolute animate-confetti text-2xl`" :style="`
          left: ${Math.random() * 100}%;
          animation-delay: ${Math.random() * 2}s;
          animation-duration: ${Math.random() * 3 + 2}s;
          color: ${['#fbbf24', '#60a5fa', '#34d399', '#f87171', '#a78bfa'][Math.floor(Math.random() * 5)]};
        `">
        {{ ['ğŸ‰', 'ğŸŠ', 'âœ¨', 'ğŸ†', 'ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ', 'ğŸ…', 'ğŸˆ'][i % 10] }}
      </div>

      <!-- Floating success icons -->
      <div v-for="i in 12" :key="'success-' + i" :class="`absolute animate-float-slow text-4xl opacity-20`" :style="`
          left: ${Math.random() * 100}%;
          top: ${Math.random() * 100}%;
          animation-delay: ${Math.random() * 3}s;
          animation-duration: ${Math.random() * 20 + 15}s;
        `">
        âœ…
      </div>

      <!-- Shining rays effect -->
      <div class="absolute inset-0 overflow-hidden opacity-10">
        <div v-for="i in 8" :key="'ray-' + i"
          class="absolute h-1 bg-gradient-to-r from-transparent via-yellow-400 to-transparent" :style="`
            width: 50%;
            top: 50%;
            left: 50%;
            transform-origin: left center;
            transform: rotate(${i * 45}deg);
            animation: ray-glow 3s ease-in-out infinite;
            animation-delay: ${i * 0.2}s;
          `">
        </div>
      </div>
    </div>

    <!-- Main success card -->
    <div class="relative z-10 w-full max-w-4xl mx-auto">
      <!-- Celebration header -->
      <div class="text-center mb-10 md:mb-12">
        <!-- Animated trophy -->
        <div class="relative inline-block mb-8">
          <div
            class="w-32 h-32 rounded-full bg-gradient-to-r from-yellow-400 via-orange-500 to-amber-600 flex items-center justify-center shadow-2xl animate-bounce-slow">
            <span class="text-7xl">ğŸ†</span>
          </div>

          <!-- Orbiting medals -->
          <div v-for="i in 3" :key="'medal-orbit-' + i"
            class="absolute w-16 h-16 rounded-full border-2 border-yellow-400/30" :style="`
              top: 50%;
              left: 50%;
              margin-top: -32px;
              margin-left: -32px;
              transform: rotate(${i * 120}deg) translateY(-120px) rotate(-${i * 120}deg);
              animation: orbit ${8 + i * 2}s linear infinite;
            `">
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-3xl">
              {{ ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][i - 1] }}
            </div>
          </div>

          <!-- Sparkles -->
          <div
            class="absolute -top-2 -right-2 w-8 h-8 rounded-full bg-gradient-to-r from-yellow-300 to-orange-400 animate-ping">
          </div>
          <div
            class="absolute -bottom-2 -left-2 w-6 h-6 rounded-full bg-gradient-to-r from-cyan-300 to-blue-400 animate-ping"
            style="animation-delay: 0.5s"></div>
        </div>

        <h1 class="text-5xl md:text-6xl font-black mb-6">
          <span class="bg-gradient-to-r from-yellow-300 via-orange-400 to-amber-500 bg-clip-text text-transparent">
            ØªØ¨Ø±ÛŒÚ© Ù…ÛŒâ€ŒÚ¯ÙˆÛŒÛŒÙ…! ğŸŠ
          </span>
        </h1>

        <p class="text-2xl font-bold text-white mb-4">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯</p>
        <p class="text-cyan-100/80 text-lg max-w-2xl mx-auto">
          Ø´Ù…Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø±Ø³Ù…ÛŒ Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø´Ù†Ø§ÛŒ Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ø±Ú©Øª Ø®ÙˆØ§Ù‡ÛŒØ¯ Ú©Ø±Ø¯
        </p>
      </div>

      <!-- Success card -->
      <div
        class="bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden mb-10">
        <!-- Success ribbon -->
        <div class="relative h-3 bg-gradient-to-r from-emerald-500 via-green-500 to-cyan-500"></div>
        <div class="absolute top-0 right-0">
          <div class="relative">
            <div
              class="w-40 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 transform rotate-45 translate-x-12 -translate-y-2">
            </div>
            <div class="absolute top-3 right-4 text-sm font-bold text-white">Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡</div>
          </div>
        </div>

        <!-- Success content -->
        <div class="p-8 md:p-12">
          <!-- Success icon -->
          <div class="flex justify-center mb-10">
            <div class="relative">
              <div
                class="w-24 h-24 rounded-full bg-gradient-to-r from-emerald-500 to-green-600 flex items-center justify-center shadow-lg">
                <span class="text-5xl">âœ…</span>
              </div>
              <div class="absolute -inset-6 rounded-full border-4 border-emerald-400/30 animate-pulse-slow"></div>
            </div>
          </div>

          <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-white mb-6">Ø¬Ø²Ø¦ÛŒØ§Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h2>
            <p class="text-cyan-200/80 text-lg mb-10">
              Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øª Ø´Ø¯. Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø´Ù…Ø§:
            </p>

            <!-- Tracking code -->
            <div class="inline-block mb-10">
              <div class="bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border border-cyan-400/30 rounded-2xl p-6">
                <p class="text-sm text-cyan-300 mb-2">Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ</p>
                <div class="text-3xl font-mono font-bold text-white tracking-widest bg-black/30 p-4 rounded-xl">
                  {{ generateTrackingCode() }}
                </div>
                <p class="text-sm text-cyan-200/70 mt-3">
                  Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯
                </p>
              </div>
            </div>

            <!-- Important notes -->
            <div class="bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-cyan-400/30 rounded-2xl p-6">
              <div class="flex items-start">
                <div class="text-3xl">ğŸ“‹</div>
                <div>
                  <h4 class="text-xl font-bold text-white mb-4">Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ø¹Ø¯ Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h4>
                  <ul class="space-y-3 text-cyan-100/80">
                    <li class="flex items-start">
                      <span class="text-green-400 ml-3 mt-1">â€¢</span>
                      <span>ÙØ§Ú©ØªÙˆØ± Ùˆ Ø±Ø³ÛŒØ¯ Ø±Ø§ Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¨Ø®Ø´ Ù¾Ø§ÛŒÛŒÙ† Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</span>
                    </li>
                    <li class="flex items-start">
                      <span class="text-green-400 ml-3 mt-1">â€¢</span>
                      <span>Ø­Ø¶ÙˆØ± Ø­Ø¯Ø§Ù‚Ù„ Û± Ø³Ø§Ø¹Øª Ù‚Ø¨Ù„ Ø§Ø² Ø´Ø±ÙˆØ¹ Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª</span>
                    </li>
                    <li class="flex items-start">
                      <span class="text-green-400 ml-3 mt-1">â€¢</span>
                      <span>Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¨Ø§Ù„Ø§ Ø±Ø§ Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Contact info -->
          <div
            class="text-center p-6 rounded-2xl bg-gradient-to-r from-emerald-500/10 to-green-500/10 border border-emerald-400/30">
            <h4 class="text-lg font-bold text-white mb-4 flex items-center justify-center">
              <span class="ml-2">ğŸ“</span>
              Ø±Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±ØªØ¨Ø§Ø·ÛŒ
            </h4>
            <div class="flex flex-wrap justify-center gap-6">
              <div class="flex items-center">
                <div
                  class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-500/20 to-cyan-500/20 flex items-center justify-center ml-3">
                  <span class="text-lg">ğŸ“±</span>
                </div>
                <div class="text-right">
                  <p class="text-sm text-cyan-200">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ„ÙÙ†ÛŒ</p>
                  <p class="font-bold text-white dir-ltr">09195486890</p>
                </div>
              </div>
              <div class="flex items-center">
                <div
                  class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500/20 to-pink-500/20 flex items-center justify-center ml-3">
                  <span class="text-lg">ğŸ“</span>
                </div>
                <div class="text-right">
                  <p class="text-sm text-cyan-200">Ø¢Ø¯Ø±Ø³ Ø§Ø³ØªØ®Ø±</p>
                  <p class="font-bold text-white">Ø§Ø³ØªØ®Ø± Ø´Ù‡ÛŒØ¯ Ø±Ø¦ÛŒØ³ÛŒØŒ Ù‚Ø²ÙˆÛŒÙ†</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Action buttons -->
      <div class="flex flex-col sm:flex-row justify-center items-center gap-6">
        <button @click="downloadCertificate"
          class="group px-10 py-5 rounded-xl bg-gradient-to-r from-yellow-500 to-orange-600 text-white font-bold text-lg shadow-lg hover:shadow-yellow-500/30 hover:-translate-y-1 transition-all duration-300 flex items-center justify-center w-full sm:w-auto">
          <span class="ml-3">ğŸ“„</span>
          Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú¯ÙˆØ§Ù‡ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
          <span class="mr-3 text-xl transform group-hover:scale-110 transition-transform">â¬‡ï¸</span>
        </button>

        <button @click="printSummary"
          class="group px-10 py-5 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold text-lg shadow-lg hover:shadow-cyan-500/30 hover:-translate-y-1 transition-all duration-300 flex items-center justify-center w-full sm:w-auto">
          <span class="ml-3">ğŸ–¨ï¸</span>
          Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ± Ùˆ Ø±Ø³ÛŒØ¯
          <span class="mr-3 text-xl transform group-hover:scale-110 transition-transform">ğŸ“‹</span>
        </button>
      </div>

      <!-- Final message -->
      <div class="text-center mt-12 pt-8 border-t border-white/10">
        <p class="text-cyan-200/70 mb-2">Ø¨Ø§ ØªØ´Ú©Ø± Ø§Ø² Ø§Ø¹ØªÙ…Ø§Ø¯ Ø´Ù…Ø§ Ø¨Ù‡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø´Ù†Ø§ÛŒ Ø§Ø³ØªØ§Ù†ÛŒ</p>
        <div class="flex items-center justify-center space-x-2 space-x-reverse">
          <span class="text-2xl">ğŸŠâ€â™‚ï¸</span>
          <span class="text-lg font-bold text-white">Ù…ÙˆÙÙ‚ Ùˆ Ù¾ÛŒØ±ÙˆØ² Ø¨Ø§Ø´ÛŒØ¯!</span>
          <span class="text-2xl">ğŸŠâ€â™€ï¸</span>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { useRouter } from "vue-router";
import { ref, computed, onMounted } from "vue";

const router = useRouter();

// Load data from all available sources
const loadCompleteData = () => {
  try {
    // 1. Ø§Ø² sessionStorage
    const raw = JSON.parse(sessionStorage.getItem("submission-response") || "{}");
    const reg = JSON.parse(sessionStorage.getItem("registration-step") || "{}");
    const personal = JSON.parse(sessionStorage.getItem("user-full") || "{}");
    const userBase = JSON.parse(sessionStorage.getItem("user-base") || "{}");

    // 2. Ø§Ø² localStorage
    const storageKey = 'swim_registration_form';
    const localData = JSON.parse(localStorage.getItem(storageKey) || "{}");

    // 3. Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø§Ø² localStorage
    const selectedMajorsStorage = localStorage.getItem('selectedMajors');
    const selectedMajors = selectedMajorsStorage ? JSON.parse(selectedMajorsStorage) : [];

    // Ø§Ø¯ØºØ§Ù… ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª
    const completeData = {
      // Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§ sessionStorage
      ...raw,
      ...reg,
      ...personal,
      ...userBase,
      // Ø³Ù¾Ø³ localStorage
      ...localData,
      // Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
      majors: selectedMajors || personal.majors || reg.selectedMajors || [],
      // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ
      loadingTime: new Date().toISOString()
    };

    console.log('Complete data loaded:', completeData);
    return completeData;

  } catch (error) {
    console.error('Error loading complete data:', error);
    return {};
  }
};

// Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„
const full = ref(loadCompleteData());

// Ù‡Ù…Ú†Ù†ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø¯Ø± mounted Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒÙ…
onMounted(() => {
  // ÛŒÚ© Ø¨Ø§Ø± Ø¯ÛŒÚ¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  full.value = loadCompleteData();

  // Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù†ØŒ localStorage Ø±Ø§ Ù†ÛŒØ² Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  console.log('LocalStorage data:', localStorage.getItem('swim_registration_form'));
  console.log('Selected majors from localStorage:', localStorage.getItem('selectedMajors'));
});

const competitionDate = computed(() => {
  return full.value.age < 12 ? 'Û´ Ø¯ÛŒ Û±Û´Û°Û´' : 'Ûµ Ø¯ÛŒ Û±Û´Û°Û´';
});

// ØªØ§Ø¨Ø¹ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ
function generateTrackingCode() {
  // Ø§Ø¨ØªØ¯Ø§ Ø§Ø² sessionStorage Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  const sessionCode = sessionStorage.getItem('tracking-code');
  if (sessionCode) return sessionCode;

  // Ø³Ù¾Ø³ Ø§Ø² localStorage Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  const nationalCode = full.value?.nationalCode ||
    full.value.personal?.nationalCode ||
    full.value.registration?.nationalCode ||
    'UNKNOWN';

  const storedCode = localStorage.getItem('tracking-code-' + nationalCode);
  if (storedCode) {
    // Ø¯Ø± sessionStorage Ù‡Ù… Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
    sessionStorage.setItem('tracking-code', storedCode);
    return storedCode;
  }

  // Ø§Ú¯Ø± Ú©Ø¯ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´ØªØŒ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  let hash = 0;
  const inputString = nationalCode + Date.now().toString();
  for (let i = 0; i < inputString.length; i++) {
    hash = (hash << 5) - hash + inputString.charCodeAt(i);
    hash |= 0;
  }

  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  let code = 'SWIM-';
  for (let i = 0; i < 8; i++) {
    code += chars[Math.abs((hash >> (i * 4)) % chars.length)];
  }

  // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ù‡Ø± Ø¯Ùˆ Ù…Ø­Ù„
  localStorage.setItem('tracking-code-' + nationalCode, code);
  sessionStorage.setItem('tracking-code', code);

  return code;
}

const trackingCode = ref(generateTrackingCode());

// ØªØ§Ø¨Ø¹ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù†Ø§Ù… Ø±Ø´ØªÙ‡
function getMajorName(major) {
  const majors = {
    parvane: "Ù¾Ø±ÙˆØ§Ù†Ù‡",
    sine: "Ø³ÛŒÙ†Ù‡",
    posht: "Ù¾Ø´Øª",
    ghorbaqe: "ØºÙˆØ±Ø¨Ø§ØºÙ‡",
    all: "Ù‡Ù…Ù‡ Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§",
    freestyle: "Ø¢Ø²Ø§Ø¯",
    backstroke: "Ù¾Ø´Øª",
    breaststroke: "Ø³ÛŒÙ†Ù‡",
    butterfly: "Ù¾Ø±ÙˆØ§Ù†Ù‡"
  };

  // Ø§Ú¯Ø± Ø±Ø´ØªÙ‡ Ø§Ø² Ø¢Ø±Ø§ÛŒÙ‡ Ø¨Ø§Ø´Ø¯
  if (Array.isArray(major)) {
    return major.map(m => majors[m] || m).join('ØŒ ');
  }

  // Ø§Ú¯Ø± Ø±Ø´ØªÙ‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø§Ø´Ø¯
  return majors[major] || major || full.value.majorTitle || full.value.registration?.majorTitle || '---';
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø§Ù… Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
function getSelectedMajors() {
  // Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
  if (full.value.majors && full.value.majors.length > 0) {
    return getMajorName(full.value.majors);
  }

  if (full.value.registration?.majors) {
    return getMajorName(full.value.registration.majors);
  }

  if (full.value.personal?.major) {
    return getMajorName(full.value.personal.major);
  }

  if (full.value.selectedMajors) {
    return getMajorName(full.value.selectedMajors);
  }

  return '---';
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø§Ù… Ú©Ø§Ù…Ù„
function getFullName() {
  const name = full.value.name ||
    full.value.personal?.name ||
    full.value.registration?.name ||
    '---';

  const fatherName = full.value.fatherName ||
    full.value.personal?.fatherName ||
    full.value.registration?.fatherName ||
    '';

  if (fatherName) {
    return `${name} ${fatherName}`;
  }

  return name;
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯ Ù…Ù„ÛŒ
function getNationalCode() {
  return full.value.nationalCode ||
    full.value.personal?.nationalCode ||
    full.value.registration?.nationalCode ||
    '---';
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ù‡
function getRaceName() {
  return full.value.raceName ||
    full.value.registration?.raceName ||
    full.value.personal?.raceName ||
    'Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ù†Ø§';
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø±Ø¯Ù‡ Ø³Ù†ÛŒ
function getCategoryLabel() {
  return full.value.categoryLabel ||
    full.value.registration?.categoryLabel ||
    full.value.personal?.categoryLabel ||
    (full.value.age ? `Ø±Ø¯Ù‡ Ø³Ù†ÛŒ ${full.value.age} Ø³Ø§Ù„` : '---');
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø²Ù…Ø§Ù† Ø¯ÙˆØ±Ù‡
function getPeriodTime() {
  return full.value.periodTime ||
    full.value.registration?.periodTime ||
    full.value.personal?.periodTime ||
    competitionDate.value;
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø²ÛŒÙ†Ù‡
function getFee() {
  const fee = full.value.fee ||
    full.value.registrationFee ||
    full.value.registration?.fee ||
    full.value.personal?.registrationFee ||
    0;

  return fee ? fee.toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†' : 'Ø±Ø§ÛŒÚ¯Ø§Ù†';
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
function getRegistrationDateTime() {
  if (full.value.personal?.registrationDate && full.value.personal?.registrationTime) {
    return `${full.value.personal.registrationDate} - ${full.value.personal.registrationTime}`;
  }

  // Ø§Ú¯Ø± Ø¯Ø± sessionStorage Ù†Ø¨ÙˆØ¯ØŒ Ø§Ø² localStorage Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  const savedData = JSON.parse(localStorage.getItem('swim_registration_form') || "{}");
  if (savedData.savedAt) {
    const date = new Date(savedData.savedAt);
    return `${date.toLocaleDateString('fa-IR')} - ${date.toLocaleTimeString('fa-IR')}`;
  }

  // Ø¯Ø± Ù†Ù‡Ø§ÛŒØª ØªØ§Ø±ÛŒØ® Ø¬Ø§Ø±ÛŒ
  return new Date().toLocaleDateString('fa-IR') + ' - ' + new Date().toLocaleTimeString('fa-IR');
}

// ØªØ§Ø¨Ø¹ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú¯ÙˆØ§Ù‡ÛŒ
function downloadCertificate() {
  // Ø§ÛŒØ¬Ø§Ø¯ HTML Ú¯ÙˆØ§Ù‡ÛŒ Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„
  const certificateHTML = `
    <!DOCTYPE html>
    <html dir="rtl">
    <head>
      <meta charset="UTF-8">
      <title>Ú¯ÙˆØ§Ù‡ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø´Ù†Ø§</title>
      <style>
        @page { size: A4 landscape; margin: 0; }
        body {
          font-family: 'B Nazanin', 'Iranian Sans', Tahoma, sans-serif;
          margin: 0;
          padding: 40px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .certificate {
          width: 100%;
          max-width: 1000px;
          background: white;
          border-radius: 20px;
          padding: 50px;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
          position: relative;
          overflow: hidden;
        }
        .watermark {
          position: absolute;
          font-size: 300px;
          opacity: 0.05;
          color: #0066cc;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          z-index: 0;
        }
        .content {
          position: relative;
          z-index: 1;
          text-align: center;
        }
        .header {
          margin-bottom: 40px;
        }
        .header h1 {
          color: #0066cc;
          font-size: 36px;
          margin-bottom: 10px;
        }
        .header h2 {
          color: #00cfff;
          font-size: 24px;
        }
        .user-info {
          margin: 30px 0;
          padding: 30px;
          background: #f8f9fa;
          border-radius: 15px;
          text-align: right;
        }
        .info-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 15px;
          padding-bottom: 15px;
          border-bottom: 1px dashed #ddd;
        }
        .info-row:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .label {
          color: #666;
          font-weight: bold;
        }
        .value {
          color: #333;
          font-size: 18px;
        }
        .footer {
          margin-top: 40px;
          padding-top: 30px;
          border-top: 2px solid #00cfff;
          display: flex;
          justify-content: space-between;
        }
        .signature {
          text-align: center;
        }
        .signature-line {
          width: 200px;
          border-top: 1px solid #333;
          margin: 20px auto 10px;
        }
        .tracking-code {
          background: linear-gradient(90deg, #00cfff, #0066ff);
          color: white;
          padding: 15px 30px;
          border-radius: 10px;
          font-size: 24px;
          font-weight: bold;
          letter-spacing: 2px;
          margin: 30px auto;
          display: inline-block;
        }
        .logo {
          font-size: 48px;
          margin-bottom: 20px;
        }
        @media print {
          body { background: white; }
          .certificate { box-shadow: none; }
        }
      </style>
    </head>
    <body>
      <div class="certificate">
        <div class="watermark">ğŸŠ</div>
        <div class="content">
          <div class="logo">ğŸ†</div>
          <div class="header">
            <h1>Ú¯ÙˆØ§Ù‡ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ù†Ø§</h1>
            <h2>Ø¯ÛŒâ€ŒÙ…Ø§Ù‡ Û±Û´Û°Û´ - Ø§Ø³ØªØ®Ø± Ø´Ù‡ÛŒØ¯ Ø±Ø¦ÛŒØ³ÛŒ</h2>
          </div>

          <div class="tracking-code">
            ${trackingCode.value}
          </div>

          <div class="user-info">
            <div class="info-row">
              <span class="label">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</span>
              <span class="value">${getFullName()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ú©Ø¯ Ù…Ù„ÛŒ:</span>
              <span class="value">${getNationalCode()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ø±Ø´ØªÙ‡ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ:</span>
              <span class="value">${getSelectedMajors()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ù…Ø³Ø§Ø¨Ù‚Ù‡:</span>
              <span class="value">${getRaceName()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ø±Ø¯Ù‡ Ø³Ù†ÛŒ:</span>
              <span class="value">${getCategoryLabel()}</span>
            </div>
            <div class="info-row">
              <span class="label">ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ù…Ø³Ø§Ø¨Ù‚Ù‡:</span>
              <span class="value">${getPeriodTime()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ù‡Ø²ÛŒÙ†Ù‡:</span>
              <span class="value">${getFee()}</span>
            </div>
            <div class="info-row">
              <span class="label">Ù†Ø§Ù… Ù…Ø¯Ø±Ø³Ù‡:</span>
              <span class="value">${full.value.schoolName || full.value.personal?.schoolName || '---'}</span>
            </div>
            <div class="info-row">
              <span class="label">Ù…Ø±Ø¨ÛŒ:</span>
              <span class="value">${full.value.coachName || full.value.personal?.coachName || '---'}</span>
            </div>
            <div class="info-row">
              <span class="label">Ø³Ø§Ù„ ØªÙˆÙ„Ø¯:</span>
              <span class="value">${full.value.birthYear || full.value.personal?.birthYear || '---'}</span>
            </div>
            <div class="info-row">
              <span class="label">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…:</span>
              <span class="value">${getRegistrationDateTime()}</span>
            </div>
          </div>

          <div class="footer">
            <div class="signature">
              <p>Ù…Ù‡Ø± Ùˆ Ø§Ù…Ø¶Ø§ÛŒ Ù…Ø³Ø¦ÙˆÙ„ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</p>
              <div class="signature-line"></div>
              <p>Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ù†Ø§</p>
            </div>
            <div class="signature">
              <p>ØªØ£ÛŒÛŒØ¯ÛŒÙ‡ Ú©Ù…ÛŒØªÙ‡ Ø¨Ø±Ú¯Ø²Ø§Ø±ÛŒ</p>
              <div class="signature-line"></div>
              <p>ÙØ¯Ø±Ø§Ø³ÛŒÙˆÙ† Ø´Ù†Ø§</p>
            </div>
          </div>

          <div style="margin-top: 30px; color: #666; font-size: 14px; text-align: center;">
            <p>Ø§ÛŒÙ† Ø³Ù†Ø¯ Ø¨Ù‡ Ù…Ù†Ø²Ù„Ù‡ ØªØ£ÛŒÛŒØ¯ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø±Ø³Ù…ÛŒ Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯.</p>
            <p>Ù„Ø·ÙØ§Ù‹ Ú©Ø§Ø±Øª Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ùˆ Ø§ÛŒÙ† Ú¯ÙˆØ§Ù‡ÛŒ Ø±Ø§ Ø¯Ø± Ø±ÙˆØ² Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.</p>
          </div>
        </div>
      </div>
    </body>
    </html>
  `;

  const blob = new Blob([certificateHTML], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `Ú¯ÙˆØ§Ù‡ÛŒ_Ø«Ø¨Øª_Ù†Ø§Ù…_${getFullName().replace(/\s+/g, '_')}.html`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// ØªØ§Ø¨Ø¹ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾ Ø®Ù„Ø§ØµÙ‡
function printSummary() {
  const printWindow = window.open('', '_blank');

  const printHTML = `
    <!DOCTYPE html>
    <html dir="rtl">
    <head>
      <meta charset="UTF-8">
      <title>ÙØ§Ú©ØªÙˆØ± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø´Ù†Ø§</title>
      <style>
        @page { size: A4; margin: 20mm; }
        body {
          font-family: 'B Nazanin', 'Iranian Sans', Tahoma, sans-serif;
          line-height: 1.6;
          color: #333;
        }
        .invoice-header {
          text-align: center;
          margin-bottom: 30px;
          padding-bottom: 20px;
          border-bottom: 3px solid #00cfff;
        }
        .invoice-header h1 {
          color: #0066cc;
          margin: 0;
          font-size: 28px;
        }
        .invoice-header h2 {
          color: #00cfff;
          margin: 10px 0;
          font-size: 20px;
        }
        .invoice-details {
          display: flex;
          justify-content: space-between;
          margin-bottom: 30px;
        }
        .section {
          margin-bottom: 25px;
          padding: 20px;
          border: 1px solid #ddd;
          border-radius: 10px;
        }
        .section h3 {
          color: #0066cc;
          margin-top: 0;
          padding-bottom: 10px;
          border-bottom: 2px solid #00cfff;
        }
        .info-grid {
          display: grid;
          grid-template-columns: 1fr 2fr;
          gap: 15px;
        }
        .info-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px dashed #eee;
        }
        .info-item:last-child {
          border-bottom: none;
        }
        .label {
          color: #666;
          font-weight: bold;
        }
        .value {
          color: #333;
          text-align: left;
        }
        .tracking {
          background: #f8f9fa;
          padding: 15px;
          border-radius: 8px;
          text-align: center;
          margin: 20px 0;
        }
        .tracking-code {
          font-family: monospace;
          font-size: 22px;
          font-weight: bold;
          color: #0066cc;
          letter-spacing: 2px;
          margin: 10px 0;
        }
        .total {
          background: linear-gradient(90deg, #00cfff, #0066ff);
          color: white;
          padding: 20px;
          border-radius: 10px;
          text-align: center;
          margin: 30px 0;
        }
        .total-amount {
          font-size: 28px;
          font-weight: bold;
        }
        .footer {
          text-align: center;
          margin-top: 40px;
          padding-top: 20px;
          border-top: 2px solid #ddd;
          color: #666;
          font-size: 14px;
        }
        .logo {
          font-size: 40px;
          margin-bottom: 10px;
        }
        @media print {
          body { padding: 0; }
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="invoice-header">
        <div class="logo">ğŸŠ</div>
        <h1>ÙØ§Ú©ØªÙˆØ± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ù†Ø§</h1>
        <h2>Ø¯ÛŒâ€ŒÙ…Ø§Ù‡ Û±Û´Û°Û´ - Ø§Ø³ØªØ®Ø± Ø´Ù‡ÛŒØ¯ Ø±Ø¦ÛŒØ³ÛŒ</h2>
        <p>ØªØ§Ø±ÛŒØ® ØµØ¯ÙˆØ±: ${getRegistrationDateTime()}</p>
      </div>

      <div class="tracking">
        <p><strong>Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ:</strong></p>
        <div class="tracking-code">${trackingCode.value}</div>
        <p style="color: #666; font-size: 14px;">Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯</p>
      </div>

      <div class="invoice-details">
        <div style="flex: 1;">
          <p><strong>Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†Ù†Ø¯Ù‡:</strong> ${getFullName()}</p>
          <p><strong>Ú©Ø¯ Ù…Ù„ÛŒ:</strong> ${getNationalCode()}</p>
          <p><strong>ØªÙ„ÙÙ†:</strong> ${full.value.phone || full.value.personal?.phone || '---'}</p>
        </div>
        <div style="flex: 1; text-align: left;">
          <p><strong>Ø´Ù…Ø§Ø±Ù‡ ÙØ§Ú©ØªÙˆØ±:</strong> ${Date.now().toString().slice(-8)}</p>
          <p><strong>ØªØ§Ø±ÛŒØ® Ù…Ø³Ø§Ø¨Ù‚Ù‡:</strong> ${getPeriodTime()}</p>
          <p><strong>Ù…Ø¯Ø±Ø³Ù‡:</strong> ${full.value.schoolName || full.value.personal?.schoolName || '---'}</p>
        </div>
      </div>

      <div class="section">
        <h3>ğŸ“‹ Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø³Ø§Ø¨Ù‚Ù‡</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">Ù†Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ù‡:</span>
            <span class="value">${getRaceName()}</span>
          </div>
          <div class="info-item">
            <span class="label">Ø±Ø´ØªÙ‡ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ:</span>
            <span class="value">${getSelectedMajors()}</span>
          </div>
          <div class="info-item">
            <span class="label">Ø±Ø¯Ù‡ Ø³Ù†ÛŒ:</span>
            <span class="value">${getCategoryLabel()}</span>
          </div>
          <div class="info-item">
            <span class="label">Ø²Ù…Ø§Ù† Ø¨Ø±Ú¯Ø²Ø§Ø±ÛŒ:</span>
            <span class="value">${getPeriodTime()}</span>
          </div>
          <div class="info-item">
            <span class="label">Ù…Ú©Ø§Ù†:</span>
            <span class="value">Ø§Ø³ØªØ®Ø± Ø´Ù‡ÛŒØ¯ Ø±Ø¦ÛŒØ³ÛŒØŒ ØªÙ‡Ø±Ø§Ù†</span>
          </div>
          <div class="info-item">
            <span class="label">Ù…Ø±Ø¨ÛŒ:</span>
            <span class="value">${full.value.coachName || full.value.personal?.coachName || '---'}</span>
          </div>
        </div>
      </div>

      <div class="section">
        <h3>ğŸ’° Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø§Ù„ÛŒ</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">Ù‡Ø²ÛŒÙ†Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…:</span>
            <span class="value">${getFee()}</span>
          </div>
          <div class="info-item">
            <span class="label">ØªØ®ÙÛŒÙ:</span>
            <span class="value">Û° ØªÙˆÙ…Ø§Ù†</span>
          </div>
          <div class="info-item">
            <span class="label">Ù…Ø§Ù„ÛŒØ§Øª:</span>
            <span class="value">Û° ØªÙˆÙ…Ø§Ù†</span>
          </div>
        </div>
      </div>

      <div class="total">
        <p>Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª</p>
        <div class="total-amount">
          ${getFee()}
        </div>
      </div>

      <div class="section">
        <h3>ğŸ“‹ Ø´Ø±Ø§ÛŒØ· Ùˆ Ø¶ÙˆØ§Ø¨Ø·</h3>
        <ul style="color: #666; padding-right: 20px;">
          <li>Ø­Ø¶ÙˆØ± Ø­Ø¯Ø§Ù‚Ù„ Û± Ø³Ø§Ø¹Øª Ù‚Ø¨Ù„ Ø§Ø² Ø´Ø±ÙˆØ¹ Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª</li>
          <li>Ú©Ø§Ø±Øª Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§ØµÙ„ Ø¯Ø± Ø±ÙˆØ² Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯</li>
          <li>Ù…Ø¯Ø§Ø±Ú© Ø¨ÛŒÙ…Ù‡ ÙˆØ±Ø²Ø´ÛŒ Ø¨Ø§ÛŒØ¯ Ù…Ø¹ØªØ¨Ø± Ø¨Ø§Ø´Ø¯</li>
          <li>Ø§ÛŒÙ† ÙØ§Ú©ØªÙˆØ± Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ù…Ø¹ØªØ¨Ø± Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯</li>
          <li>Ú¯ÙˆØ§Ù‡ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ ÛŒØ§ Ù¾Ø±ÛŒÙ†Øª Ù†Ù…Ø§ÛŒÛŒØ¯</li>
        </ul>
      </div>

      <div class="footer">
        <p><strong>Ø¢Ø¯Ø±Ø³:</strong> Ù‚Ø²ÙˆÛŒÙ†ØŒ Ø§Ø³ØªØ®Ø± Ø´Ù‡ÛŒØ¯ Ø±Ø¦ÛŒØ³ÛŒ</p>
        <p>Ø¨Ø§ ØªØ´Ú©Ø± Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ù…Ø§ Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ø³ØªØ§Ù†ÛŒ Ø´Ù†Ø§</p>
        <p style="margin-top: 20px; font-size: 12px;">Ø§ÛŒÙ† ÙØ§Ú©ØªÙˆØ± Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ùˆ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…Ù‡Ø± Ùˆ Ø§Ù…Ø¶Ø§ Ù†Ø¯Ø§Ø±Ø¯</p>
      </div>

      <div class="no-print" style="text-align: center; margin-top: 30px;">
        <button onclick="window.print()" style="padding: 10px 20px; background: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer;">
          ğŸ–¨ï¸ Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ±
        </button>
      </div>
    </body>
    </html>
  `;

  printWindow.document.write(printHTML);
  printWindow.document.close();
  printWindow.focus();

  // Auto print after load
  printWindow.onload = function () {
    setTimeout(() => {
      printWindow.print();
      printWindow.close();
    }, 500);
  };
}

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
function again() {
  // Clear all session data
  sessionStorage.removeItem("user-base");
  sessionStorage.removeItem("user-full");
  sessionStorage.removeItem("registration-step");
  sessionStorage.removeItem("uploads");
  sessionStorage.removeItem("submission-response");
  sessionStorage.removeItem("registration-complete");
  sessionStorage.removeItem("tracking-code");

  // Clear registration form data from localStorage
  localStorage.removeItem('swim_registration_form');
  localStorage.removeItem('selectedMajors');

  router.push("/");
}
</script>

<style>
/* Custom animations */
@keyframes confetti {
  0% {
    transform: translateY(-100px) rotate(0deg);
    opacity: 1;
  }

  100% {
    transform: translateY(100vh) rotate(360deg);
    opacity: 0;
  }
}

@keyframes float-slow {
  0% {
    transform: translateY(0) rotate(0deg);
    opacity: 0.2;
  }

  50% {
    opacity: 0.3;
  }

  100% {
    transform: translateY(-100vh) rotate(360deg);
    opacity: 0;
  }
}

@keyframes ray-glow {

  0%,
  100% {
    opacity: 0.1;
  }

  50% {
    opacity: 0.3;
  }
}

@keyframes bounce-slow {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-20px);
  }
}

@keyframes pulse-slow {

  0%,
  100% {
    transform: scale(1);
    opacity: 0.3;
  }

  50% {
    transform: scale(1.05);
    opacity: 0.5;
  }
}

@keyframes orbit {
  from {
    transform: rotate(0deg) translateY(-120px) rotate(0deg);
  }

  to {
    transform: rotate(360deg) translateY(-120px) rotate(-360deg);
  }
}

.animate-confetti {
  animation: confetti linear forwards;
}

.animate-float-slow {
  animation: float-slow linear infinite;
}

.animate-bounce-slow {
  animation: bounce-slow 2s ease-in-out infinite;
}

.animate-pulse-slow {
  animation: pulse-slow 3s ease-in-out infinite;
}

/* RTL support for numbers */
.dir-ltr {
  direction: ltr;
  display: inline-block;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .info-grid {
    grid-template-columns: 1fr;
  }

  .contact-info {
    flex-direction: column;
    gap: 1rem;
  }
}
</style>
